name: ì¬ì˜ë ˆí¬ì— ë³µì œ

on:
  push:
    branches:
      - main

jobs:
  sync-to-fork:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout your code
        uses: actions/checkout@v3

      - name: Add friend's repo and push
        run: |
          # ë””ë²„ê¹…: í† í°ì´ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ (ì‹¤ì œ ê°’ì€ í‘œì‹œí•˜ì§€ ì•ŠìŒ)
          if [ -z "${{ secrets.FRIEND_PAT }}" ]; then
            echo "âŒ FRIEND_PATì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!"
            exit 1
          else
            echo "âœ… FRIEND_PATì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
          fi
          
          # Public ë ˆí¬ì§€í† ë¦¬ ì ‘ê·¼ í…ŒìŠ¤íŠ¸
          echo "ğŸ” Public ë ˆí¬ì§€í† ë¦¬ ì ‘ê·¼ í…ŒìŠ¤íŠ¸..."
          
          # Public ë ˆí¬ëŠ” í† í° ì—†ì´ë„ ì½ê¸° ê°€ëŠ¥í•˜ì§€ë§Œ, pushë¥¼ ìœ„í•´ì„œëŠ” í† í° í•„ìš”
          if git ls-remote https://github.com/sunsetcinematic/sunset-cinema.git; then
            echo "âœ… ë ˆí¬ì§€í† ë¦¬ ì ‘ê·¼ ì„±ê³µ! (Public ëª¨ë“œ)"
          else
            echo "âŒ ë ˆí¬ì§€í† ë¦¬ ì ‘ê·¼ ì‹¤íŒ¨"
            exit 1
          fi
          
          # Git ì„¤ì •
          echo "ğŸ”§ Git ì„¤ì • ì¤‘..."
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          
          # Friend ë ˆí¬ì§€í† ë¦¬ ì¶”ê°€ ë° í‘¸ì‹œ
          echo "ğŸ“¤ Friend ë ˆí¬ì§€í† ë¦¬ì— í‘¸ì‹œ ì¤‘..."
          
          # Public ë ˆí¬ì§€í† ë¦¬ì— í† í°ìœ¼ë¡œ í‘¸ì‹œ
          git remote add friend https://x-access-token:${{ secrets.FRIEND_PAT }}@github.com/sunsetcinematic/sunset-cinema.git
          
          # ê°•ì œ í‘¸ì‹œë¡œ ì™„ì „ ë™ê¸°í™”
          git push friend main --force
          
          echo "âœ… ì„±ê³µì ìœ¼ë¡œ sunsetcinematic/sunset-cinemaì— ë™ê¸°í™” ì™„ë£Œ!"
        
        # SSH ë°©ì‹ ëŒ€ì•ˆ (í•„ìš”ì‹œ ì‚¬ìš©):
        # git remote add friend git@github.com:sunsetcinematic/sunset-cinema.git
        # (SSH í‚¤ ì„¤ì • í•„ìš”)